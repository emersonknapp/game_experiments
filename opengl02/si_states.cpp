#include "si_states.h"

//****************************************************
// Title Menu
//****************************************************

M_Title::M_Title() {

}

void M_Title::init() {
  
  //m_renderables.push_back(new R_Text(-1,.5,"Title", 72));
  //m_renderables.push_back(new R_Text(-1,.2,"[P]lay", 36));
  //m_renderables.push_back(new R_Text(-1,-.1,"[Q]uit", 36));
  Transform2D titleTextTr;
  titleTextTr.translation = Vector2f(-1, .5);
  RenderInfo titleTextRI;
  titleTextRI.transform = titleTextTr;
  titleTextRI.renderable = new R_Text("Title", 72);
  
  m_renderer->addRenderable(m_oid, titleTextRI);
}

queue<StateUpdate>* M_Title::update(int mils) {
  return State::update(mils);
}

void M_Title::selectItem(int i) {
  /*
  0: [P]lay game.
  1: [Q]uit.
  */
  switch (i) {
    case 0: {
      m_updates.push((StateUpdate){ST_SWAP, ST_PLAY, 0});
      break;
    }
    case 1: {
      m_running = false;
      break;
    }
  }
}

bool M_Title_Ctrl::key(InputType itype, int k, double x, double y) {
  bool ret = true;
  switch (itype) {
    case NORM_DOWN:
      {
        unsigned char ckey = (unsigned char)k;
        switch (ckey) {
          case 'q':
          case 'Q':
            m_controlled->selectItem(1);
          break;
          case 'p':
          case 'P':
            m_controlled->selectItem(0);
          break;
          default:
          ret = false;
          break;
        }
      }
      default:
      ret = false;
  }
  return ret;
}

void M_Title_Ctrl::setControlled(Object* cont) {
  m_controlled = (M_Title*)cont;
}

//****************************************************
// Play State
//****************************************************
S_Play::S_Play() {
  m_scene = new SI_Scene();
  //m_renderer.add(m_oid, new)
  //m_renderables.push_back(new R_Text(-1,.7,"Play", 15));
}

void S_Play::init() {
  
}

queue<StateUpdate>* S_Play::update(int mils) {
  return State::update(mils);
  //return &m_updates;
}

bool S_Play_Ctrl::key(InputType itype, int k, double x, double y) {
  bool ret=true;
  switch (itype) {
   case (NORM_DOWN):
      {
        unsigned char ckey = (unsigned char)k;
        switch (ckey) {
          case 'q':
          case 'Q':
            m_controlled->kill();
          break;
          default:
          ret=false;
          break;
        }
      }
    default:
      ret=false; 
  }
  return ret;
}

void S_Play_Ctrl::setControlled(Object* cont) {
  m_controlled = (S_Play*)cont;
}

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
